# DeepQueueNet: Towards Scalable and Generalized Network Performance Estimation with Packet-level Visibility
---
# PyTorch Implementation Guide

## Install
---
First of all, please make sure that you have at least 1 GPU on hand (16GB memory is required to run the device model). To install the right dependencies, run the following to create an environment from the `env.yml` file:
```python
conda env create -f env.yml
```
It will create a new evnvironment named `dqn_torch`. To activate the new environment: 
```python
conda activate dqn_torch 
```

## Download Dataset

To train and evaluate DeepQueueNet (with `train1000.py`),  we provide some ready-to-use datasets. They are generated by a traffic generator based on the Markovian Arrival Process (MAP) and simulated with a packet-level simulator (ns.py). 

You can download the dataset from [on Dropbox](https://www.dropbox.com/s/q56sx4hxe93n4g5/DeepQueueNet-dataset.zip?dl=0). Please download the zipped archive and extract the two folders named `data` and `trained` both to root directory before proceeding. Make sure that the `base_dir` in `train1000.py`, `fattree_model.py` and `fattree_test_plot.py` is the path to the extracted folder named `data`.

## Data Preprocessing

Before training, the data needs to be preprocessed with:
```
python Dataset.py
```

## Train Device Model

The device model can be trained with:
```
python train1000.py
```

The train and validation loss are recorded in the figures in `./saved/default/train_plot`.

## FatTree Simulation

The fattree simulation can be run with:
```
python fattree_model.py
```

After that, the simulation result will be saved in the same directory with the provided trace data.


## FatTree Simulation Result Plot

The simulation result can be plotted with:
```
python fattree_test_plot.py
```

The plotted figures are saved in the directory `./saved/default/fattree_plot`.

Those plotted figures include the PDF and CDF for delay and jitter, along with the regression comparison result for the average jitter. 




